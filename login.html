<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Aparajita Computers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
    <style> body { font-family: "Poppins", sans-serif; } </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen">
    <div class="w-full max-w-md p-8 space-y-6 bg-gray-800 rounded-2xl shadow-lg">
        <div class="text-center">
            <h1 class="text-3xl font-bold text-cyan-400">Welcome Back</h1>
            <p class="text-gray-400">Please sign in to your account.</p>
        </div>

        <!-- This message area will show success or error messages -->
        <div id="message-area" class="hidden text-center p-3 rounded-md text-sm font-semibold"></div>

        <form id="login-form" class="space-y-6">
            <div>
                <label for="role" class="block text-sm font-medium text-gray-300 mb-2">Login as:</label>
                <select name="role" id="role" required class="w-full px-4 py-3 bg-gray-700 rounded-md border border-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500">
                    <option value="user">User</option>
                    <option value="admin">Admin</option>
                </select>
            </div>
            <div>
                <input type="email" name="email" placeholder="Email" required class="w-full px-4 py-3 bg-gray-700 rounded-md border border-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500" />
            </div>
            <div>
                <div class="relative">
                    <input type="password" id="password" name="password" placeholder="Password" required class="w-full px-4 py-3 pr-10 bg-gray-700 rounded-md border border-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500" />
                    <span id="togglePassword" class="absolute top-1/2 right-3 -translate-y-1/2 cursor-pointer text-gray-400 hover:text-white">
                        <!-- Eye Icon SVG -->
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>
                    </span>
                </div>
                <div class="flex justify-end mt-2">
                    <a href="forgot_password.html" class="text-xs text-cyan-400 hover:underline">Forgot Password?</a>
                </div>
            </div>
            <button type="submit" id="submit-button" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-6 rounded-md transition-colors">
                Sign In
            </button>
        </form>
        <p class="text-center text-sm text-gray-400">
            Don't have an account?
            <a href="register.html" class="font-semibold text-cyan-400 hover:underline">Register here</a>
        </p>
        <p class="text-center text-sm text-gray-400">
            <a href="index.html" class="hover:underline">&larr; Back to Home</a>
        </p>
    </div>

    <script>
        const loginForm = document.getElementById('login-form');
        const messageArea = document.getElementById('message-area');
        const submitButton = document.getElementById('submit-button');

        loginForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            submitButton.disabled = true;
            submitButton.textContent = 'Signing In...';
            messageArea.classList.add('hidden');

            const formData = new FormData(loginForm);

            try {
                const response = await fetch('login.php', {
                    method: 'POST',
                    body: formData
                });
                const result = await response.json();

                if (result.success) {
                    messageArea.textContent = 'Login successful! Redirecting...';
                    messageArea.className = 'text-center p-3 rounded-md text-sm font-semibold bg-green-500/20 text-green-300';
                    
                    setTimeout(() => {
                        // Use the redirect URL provided by the server
                        window.location.href = result.redirect; 
                    }, 1000);
                } else {
                    messageArea.textContent = result.error || 'An unknown error occurred.';
                    messageArea.className = 'text-center p-3 rounded-md text-sm font-semibold bg-red-500/20 text-red-300';
                    submitButton.disabled = false;
                    submitButton.textContent = 'Sign In';
                }
            } catch (error) {
                console.error('Login Error:', error);
                messageArea.textContent = 'A network error occurred. Please try again.';
                messageArea.className = 'text-center p-3 rounded-md text-sm font-semibold bg-red-500/20 text-red-300';
                submitButton.disabled = false;
                submitButton.textContent = 'Sign In';
            }
        });

        // Script for the password toggle icon
        const togglePassword = document.getElementById('togglePassword');
        const passwordInput = document.getElementById('password');
        const eyeIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>`;
        const eyeSlashIcon = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7 .946-3.118 3.526-5.449 6.836-6.182M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2 2l20 20" /></svg>`;
        
        togglePassword.addEventListener('click', function () {
            const isPassword = passwordInput.getAttribute('type') === 'password';
            passwordInput.setAttribute('type', isPassword ? 'text' : 'password');
            this.innerHTML = isPassword ? eyeSlashIcon : eyeIcon;
        });
    </script>
</body>
</html>


